prometheus:
  prometheusSpec:
    # Enable remote write receiver for Tempo metrics (default: false)
    enableRemoteWriteReceiver: true
    # Enable exemplar storage for metrics-traces linking (default: [])
    enableFeatures:
      - exemplar-storage
      - native-histograms
    externalLabels:
      cluster: eks-cluster
      project: todo-app
      env: prod

grafana:
  sidecar:
    dashboards:
      enabled: true
      label: grafana_dashboard
  # Enable anonymous access for demo (default: requires login)
  grafana.ini:
    auth.anonymous:
      enabled: true
      org_role: Admin
    auth:
      disable_login_form: true
    feature_toggles:
      enable: traceqlEditor

  # Add trace exploration plugin (default: no plugins)
  plugins:
    - grafana-exploretraces-app

  additionalDataSources:
    - name: Loki
      type: loki
      url: http://loki.observability-ns.svc.cluster.local:3100
      access: proxy
      jsonData:
        httpHeaderName1: "X-Scope-OrgID"
      secureJsonData:
        httpHeaderValue1: "1"

    - name: Tempo
      type: tempo
      access: proxy
      url: http://tempo.observability-ns.svc.cluster.local:3200
      uid: tempo
      jsonData:
        httpMethod: GET
        serviceMap:
          datasourceUid: prometheus
        nodeGraph:
          enabled: true
        search:
          hide: false
        tracesToMetrics:
          datasourceUid: prometheus
          spanAttributes: [service.name, http.method, http.status_code]
        tracesToLogs:
          datasourceUid: Loki
          filterByTraceId: true
          filterBySpanId: false
          lokiSearch: true
