# Tempo Single Binary Configuration with S3 Storage
deploymentMode: SingleBinary

tempo:
  # Storage configuration - S3 backend
  storage:
    trace:
      backend: s3
      s3:
        bucket: tempo-bucket-55
        region: us-east-1
        # Explicitly empty to ensure IRSA/default credential chain
        endpoint: ""
        access_key: ""
        secret_key: ""
        insecure: false

  # Metrics Generator for RED metrics from traces
  metricsGenerator:
    enabled: true
    remoteWriteUrl: "http://prometheus-kube-prometheus-prometheus.observability-ns.svc.cluster.local:9090/api/v1/write"

  # Retention configuration
  retention: 24h

# Service Account with IRSA annotation
serviceAccount:
  create: true
  name: "tempo"
  annotations:
    eks.amazonaws.com/role-arn: arn:aws:iam::864899840633:role/todo-list-app-cluster-tempo-irsa

# Global service account for all components
global:
  serviceAccount:
    create: true
    name: "tempo"
    annotations:
      eks.amazonaws.com/role-arn: arn:aws:iam::864899840633:role/todo-list-app-cluster-tempo-irsa

# Single Binary deployment
singleBinary:
  replicas: 1
  persistence:
    enabled: false
  # Writable directories for stateless mode
  extraVolumes:
    - name: data
      emptyDir: {}
  extraVolumeMounts:
    - name: data
      mountPath: /var/tempo

# Disable persistence (using S3)
persistence:
  enabled: false

# Zero out other deployment mode replicas
backend:
  replicas: 0
distributor:
  replicas: 0
ingester:
  replicas: 0
querier:
  replicas: 0
queryFrontend:
  replicas: 0
compactor:
  replicas: 0
